#### extern 和 extern "C"

##### extern关键字作用

一，引用同一个文件的变量，举例如下：

```
#include<stdio.h>

int main()
{
	printf("% d", a);
	return 0;
}

int a = 0;
```

以上程序会报错：
错误	C2065	“a”: 未声明的标识符

因为a变量在main函数后面进行声明和初始化，当在main函数中使用到a变量时并不能找到a变量。此时可以采用extern关键字告诉编译器a变量是存在的，让编译器去别的地方找找。

```
#include<stdio.h>

int main()
{
	extern int a;    //先告诉编译器有a变量。
	printf("% d", a);
	return 0;
}

int a = 0;
```

二，引用另一个文件的变量

如果整个工程由多个源文件组成，在一个源文件中想引用另外一个源文件中已经定义的外部变量，同样只需在引用变量的文件中用 extern 关键字加以声明即可，这种情况平时1使用较多。

注意：extern关键字只需要指明类型和变量名就行了，不能再重新赋值，初始化需要在原文件所在处进行，如果不进行初始化的话，全局变量会被编译器自动初始化为0。

```
extern int a = 0;   //此种写法是错误的。
```

三，引用另一个文件中的函数

extern除了引用另一个文件中的变量外，还可以引用另一个文件中的函数。

```
*** main.c****
#include<stdio.h>
 
int main()
{
  extern void test();
  test();
  return 0;
}
```

```
**** test.c****
#include<stdio.h>
 
void test()
{
  printf("主函数引用成功");
}
```

##### extern "C"

一，作用

在C++环境中使函数按照C的标准来编译和链接

二，为什么会出现这种需求？

 1，由于系统内核一般是使用C语言来编写的，系统内核中用C语言实现了很多库。而上层应用程序有可能是用C++来开发，如果在内核库函数头文件中不用extern “C”来声明库函数的话，在编写C++应用程序时，包含库头文件，在C++文件链接时就会以C++标准来链接库的函数名，而在库文件实现时是用C来实现的，二者函数名不同，在链接时就会出现找不到函数的现象。

2、在有些工程中，即包含.c文件有包含.cpp文件，如VC的工程。.cpp文件要调用.c文件中的函数时，需要extern “C” 声明.c文件中的函数，在CPP文件中让C++编译器使用C的标准来链接C文件中的函数。

三，原理

​		之所以采用这种方式，是因为两种语言之间的一些差异所导致的。由于CPP支持多态性，也就是具有相同**函数名**的函数可以完成**不**同的功能，CPP通常是通过参数区分具体调用的是哪一个函数。在编译的时候，CPP编译器会将参数类型和**函数名**连接在一起，于是在程序编译成为目标文件以后，CPP编译器可以直接根据目标文件中的符号名将多个目标文件连接成一个目标文件或者可执行文件。

​		但是在C语言中，由于完全没有多态性的概念，C编译器在编译时除了会在**函数名**前面添加一个下划线之外，什么也**不**会做.。

比如：int test()函数

在cpp文件采用cpp编译器进行编译可能编译为：_testii

如果采用c编译器会编译为：_test

所以以上情况的出现就会导致一个问题，如果在一个cpp文件中会使用到c编译程序的函数，就找不到_testii这个符号，结果出错。



四，extern "C"放在函数声明之前的作用

用(extern “C”+函数声明)，表明CPP此文件中的函数，以C的标准来链接(“_函数名”)， 如果在CPP文件中函数声明前不用extern “C”,则采用C++的标准来链接



五，extern "C"放在函数定义前的作用

extern “C”放在函数定义之前，则C++编译器使得函数按照C的标准来编译和链接函数





















